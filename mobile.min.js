"use strict";angular.module("ngMobile",[]).factory("$mobileUtils",["$window",function(a){var b,c,d,e,f=25,g=2500,h=function(a,b,c,d){return Math.abs(a-c)<f&&Math.abs(b-d)<f},i=function(a,b,c){for(var d=0;d<a.length;d+=1)if(h(a[d][0],a[d][1],b,c))return a.splice(d,d+1),!0;return!1},j=function(a){if(!(Date.now()-b>g)){var c=a.touches&&a.touches.length?a.touches:[a],f=c[0].clientX,h=c[0].clientY;1>f&&1>h||i("mousedown"==a.type?d:e,f,h)||(a.stopPropagation(),a.preventDefault())}},k=function(b){var f=b.touches&&b.touches.length?b.touches:[b],h=f[0].clientX,i=f[0].clientY,k=f[0].identifier;d.push([h,i,k]),e.push([h,i,k]),0==c&&a.document.addEventListener("mousedown",j,!0),c+=1,setTimeout(function(){var b;c-=1,0==c&&a.document.removeEventListener("mousedown",j,!0);for(var b=0;b<d.length;b+=1)if(d[b][2]==k){d.splice(b,b+1);break}for(var b=0;b<e.length;b+=1)if(e[b][2]==k){e.splice(b,b+1);break}},g)};return{preventGhostClick:function(f,h){e||(e=[],d=[],c=1,a.document.addEventListener("touchstart",k,!0),a.document.addEventListener("mousedown",j,!0),setTimeout(function(){c-=1,0==c&&a.document.removeEventListener("mousedown",j,!0)},g),a.document.addEventListener("click",j,!0)),b=Date.now(),i(d,f,h),i(e,f,h)},DIRECTION_DOWN:"down",DIRECTION_LEFT:"left",DIRECTION_UP:"up",DIRECTION_RIGHT:"right",EVENT_START:"start",EVENT_MOVE:"move",EVENT_END:"end",HAS_POINTEREVENTS:a.navigator.pointerEnabled||a.navigator.msPointerEnabled,HAS_TOUCHEVENTS:"ontouchend"in a,EVENT_TYPES:{},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var b=[],c=[],d=0,e=a.length;e>d;d++)b.push(a[d].pageX),c.push(a[d].pageY);return{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;return 180*Math.atan2(c,d)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-b.pageX),d=Math.abs(a.pageY-b.pageY);return c>=d?a.pageX-b.pageX>0?this.DIRECTION_LEFT:this.DIRECTION_RIGHT:a.pageY-b.pageY>0?this.DIRECTION_UP:this.DIRECTION_DOWN},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==this.DIRECTION_UP||a==this.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){var c,d=["webkit","khtml","moz","ms","o",""];if(b&&a.style){for(var e=0;e<d.length;e++)for(var f in b)b.hasOwnProperty(f)&&(c=f,d[e]&&(c=d[e]+c.substring(0,1).toUpperCase()+c.substring(1)),a.style[c]=b[f]);"none"==b.userSelect&&(a.onselectstart=function(){return!1},a.ondragstart=function(){return!1})}}}}]).provider("$mobile",function(){this.defaults={set_browser_behaviors:!0},this.default_browser_behavior={userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},this.$get=["$window","$document","$mobileUtils",function(a,b,c){var d=this,e={},f=0,g={},h={},i=function(b,c){a.setTimeout(function(){b.releasePointerCapture(c)},0)},j=function(b,d){b.bind(c.EVENT_TYPES[d],function(e){if(e=e.originalEvent||e,!(e.type.match(/mouse/i)&&1!=(e.which||e.button)||e.type.match(/pointerdown/i)&&0!=e.button)){var f,j,l,m=e.changedTouches&&e.changedTouches.length?e.changedTouches:e.touches&&e.touches.length?e.touches:[e],n={};for(f=0;f<m.length;++f){if(j=m[f],j.identifier="undefined"!=typeof j.identifier?j.identifier:"undefined"!=typeof j.pointerId?j.pointerId:1,d===c.EVENT_START){if(g[j.identifier]&&g[j.identifier].stopDetect(),l=b.data("__$mobile.config__"),!(l&&l.enabled&&l.pointers_count<l.pointers_max))continue;l.options.touch_active_class&&b.addClass(l.options.touch_active_class),g[j.identifier]=l,0==l.pointers_count&&(h[l]={}),h[l][j.identifier]=j,l.pointers_count=l.pointers_count+1,c.HAS_POINTEREVENTS&&(b[0].setPointerCapture||(b[0].setPointerCapture=b[0].msSetPointerCapture,b[0].releasePointerCapture=b[0].msReleasePointerCapture),b[0].setPointerCapture(j.identifier)),n[l]||(n[l]=[l])}else{if(!g[j.identifier])continue;l=g[j.identifier],h[l][j.identifier]=j,n[l]||(n[l]=[l]),d===c.EVENT_END&&(n[l].push(j.identifier),c.HAS_POINTEREVENTS&&i(b[0],j.identifier))}a.document.addEventListener||(j.pageX=j.clientX+a.document.body.scrollLeft,j.pageY=j.clientY+a.document.body.scrollTop)}for(l in n)n.hasOwnProperty(l)&&k(e,d,n[l].shift(),n[l])}})},k=function(a,b,d,e){if(d.enabled){var f=[];angular.forEach(h[d],function(a){this.push(a)},f),b===c.EVENT_END&&e.length-d.pointers_count>0&&(b=c.EVENT_MOVE),d.detect({center:c.getCenter(f),timeStamp:Date.now(),target:a.target,touches:f,eventType:b,srcEvent:a,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault?this.srcEvent.preventDefault():this.srcEvent.returnValue=!1},stopPropagation:function(){this.srcEvent.stopPropagation?this.srcEvent.stopPropagation():this.srcEvent.cancelBubble=!0},stopDetect:function(){return d.stopDetect()}})}if(b===c.EVENT_END)d.stopDetect();else for(var i=0;i<e.length;++i)delete g[e[i]],delete h[d][e[i]],d.pointers_count=d.pointers_count-1};return c.HAS_POINTEREVENTS?(c.EVENT_TYPES[c.EVENT_START]="pointerdown MSPointerDown",c.EVENT_TYPES[c.EVENT_MOVE]="pointermove MSPointerMove",c.EVENT_TYPES[c.EVENT_END]="pointerup pointercancel lostpointercapture MSPointerUp MSPointerCancel MSLostPointerCapture"):(c.EVENT_TYPES[c.EVENT_START]="touchstart mousedown",c.EVENT_TYPES[c.EVENT_MOVE]="touchmove mousemove",c.EVENT_TYPES[c.EVENT_END]="touchend touchcancel mouseup",j(b,c.EVENT_MOVE),j(b,c.EVENT_END),Date.now||(Date.now=function(){return(new Date).valueOf()})),{utils:c,register:function(a){d.defaults=angular.extend(a.defaults||{},d.defaults||{}),delete a.defaults,e[a.name]=a},gestureOn:function(a,b,i){var k,l,m=a.data("__$mobile.config__")||{id:void 0,handlers:{},registered:{},gestures:[],bind:function(a,b){return m.handlers[a]=m.handlers[a]||[],m.handlers[a].push(b),m},unbind:function(a,b){return void 0===b?delete m.handlers[a]:angular.arrayRemove(m.handlers[a],b),m},toString:function(){return m.id},extendEventData:function(a){var b,d,e=m.current.startEvent,f=a.timeStamp-e.timeStamp,g=a.center.pageX-e.center.pageX,h=a.center.pageY-e.center.pageY,i=c.getVelocity(f,g,h);if(e&&a.touches.length!=e.touches.length)for(e.touches=[],b=0,d=a.touches.length;d>b;b++)e.touches.push(a.touches[b]);return angular.extend(a,{deltaTime:f,deltaX:g,deltaY:h,velocityX:i.x,velocityY:i.y,distance:c.getDistance(e.center,a.center),angle:c.getAngle(e.center,a.center),direction:c.getDirection(e.center,a.center),scale:c.getScale(e.touches,a.touches),rotation:c.getRotation(e.touches,a.touches),startEvent:e}),a},detect:function(a){if(m.current){if(m.stopped)return}else m.stopped=!1,m.current={inst:m,startEvent:angular.extend({},a),lastEvent:!1,name:""};a=m.extendEventData(a);var b,c,d=0;for(b=m.gestures.length;b>d;d++)if(c=m.gestures[d],!m.stopped&&c.handler.call(m.registered[c.name],a,m)===!1){tracker.stopDetect();break}return m.current&&(m.current.lastEvent=a),a},stopDetect:function(){var b=h[m];m.options.touch_active_class&&a.removeClass(m.options.touch_active_class),b&&(delete h[m],angular.forEach(b,function(a,b){delete g[b]}),m.stopped=!0,m.pointers_count=0,m.current&&(m.previous=angular.extend({},m.current),m.current=null))},trigger:function(b,c){if(m.handlers[b])for(var d,e=m.handlers[b],d=0;d<e.length;++d)e[d].call(a,c);return m},enabled:!0,previous:void 0,current:void 0,pointers_count:0,pointers_max:1,options:void 0};if(m.id?i&&angular.extend(m.options,i):(i=angular.extend(angular.copy(d.defaults),i||{}),f+=1,m.id=f.toString(),m.options=i,a.data("__$mobile.config__",m),i.set_browser_behaviors&&c.stopDefaultBrowserBehavior(a[0],d.default_browser_behavior),a.scope().$on("$destroy",function(){m.stopDetect(),m.enabled=!1}),c.HAS_POINTEREVENTS?(j(a,c.EVENT_START),j(a,c.EVENT_MOVE),j(a,c.EVENT_END)):j(a,c.EVENT_START)),b)for(b=b.split(" "),k=0;k<b.length;k+=1)l=e[b[k]],m.registered[l.name]||(m.registered[l.name]={name:l.name},l.index=l.index||1e3,m.gestures.push(l),m.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0})),l.setup&&l.setup.call(m.registered[l.name],a,m),(m.options[l.name+"_max_pointers"]||1)>m.pointers_max&&(m.pointers_max=m.options[l.name+"_max_pointers"]||1);return m}}}]}),angular.module("ngMobile",[]).factory("$mobileUtils",["$window",function(a){var b,c,d,e,f=25,g=2500,h=function(a,b,c,d){return Math.abs(a-c)<f&&Math.abs(b-d)<f},i=function(a,b,c){for(var d=0;d<a.length;d+=1)if(h(a[d][0],a[d][1],b,c))return a.splice(d,d+1),!0;return!1},j=function(a){if(!(Date.now()-b>g)){var c=a.touches&&a.touches.length?a.touches:[a],f=c[0].clientX,h=c[0].clientY;1>f&&1>h||i("mousedown"==a.type?d:e,f,h)||(a.stopPropagation(),a.preventDefault())}},k=function(b){var f=b.touches&&b.touches.length?b.touches:[b],h=f[0].clientX,i=f[0].clientY,k=f[0].identifier;d.push([h,i,k]),e.push([h,i,k]),0==c&&a.document.addEventListener("mousedown",j,!0),c+=1,setTimeout(function(){var b;c-=1,0==c&&a.document.removeEventListener("mousedown",j,!0);for(var b=0;b<d.length;b+=1)if(d[b][2]==k){d.splice(b,b+1);break}for(var b=0;b<e.length;b+=1)if(e[b][2]==k){e.splice(b,b+1);break}},g)};return{preventGhostClick:function(f,h){e||(e=[],d=[],c=1,a.document.addEventListener("touchstart",k,!0),a.document.addEventListener("mousedown",j,!0),setTimeout(function(){c-=1,0==c&&a.document.removeEventListener("mousedown",j,!0)},g),a.document.addEventListener("click",j,!0)),b=Date.now(),i(d,f,h),i(e,f,h)},DIRECTION_DOWN:"down",DIRECTION_LEFT:"left",DIRECTION_UP:"up",DIRECTION_RIGHT:"right",EVENT_START:"start",EVENT_MOVE:"move",EVENT_END:"end",HAS_POINTEREVENTS:a.navigator.pointerEnabled||a.navigator.msPointerEnabled,HAS_TOUCHEVENTS:"ontouchend"in a,EVENT_TYPES:{},hasParent:function(a,b){for(;a;){if(a==b)return!0;a=a.parentNode}return!1},getCenter:function(a){for(var b=[],c=[],d=0,e=a.length;e>d;d++)b.push(a[d].pageX),c.push(a[d].pageY);return{pageX:(Math.min.apply(Math,b)+Math.max.apply(Math,b))/2,pageY:(Math.min.apply(Math,c)+Math.max.apply(Math,c))/2}},getVelocity:function(a,b,c){return{x:Math.abs(b/a)||0,y:Math.abs(c/a)||0}},getAngle:function(a,b){var c=b.pageY-a.pageY,d=b.pageX-a.pageX;return 180*Math.atan2(c,d)/Math.PI},getDirection:function(a,b){var c=Math.abs(a.pageX-b.pageX),d=Math.abs(a.pageY-b.pageY);return c>=d?a.pageX-b.pageX>0?this.DIRECTION_LEFT:this.DIRECTION_RIGHT:a.pageY-b.pageY>0?this.DIRECTION_UP:this.DIRECTION_DOWN},getDistance:function(a,b){var c=b.pageX-a.pageX,d=b.pageY-a.pageY;return Math.sqrt(c*c+d*d)},getScale:function(a,b){return a.length>=2&&b.length>=2?this.getDistance(b[0],b[1])/this.getDistance(a[0],a[1]):1},getRotation:function(a,b){return a.length>=2&&b.length>=2?this.getAngle(b[1],b[0])-this.getAngle(a[1],a[0]):0},isVertical:function(a){return a==this.DIRECTION_UP||a==this.DIRECTION_DOWN},stopDefaultBrowserBehavior:function(a,b){var c,d=["webkit","khtml","moz","ms","o",""];if(b&&a.style){for(var e=0;e<d.length;e++)for(var f in b)b.hasOwnProperty(f)&&(c=f,d[e]&&(c=d[e]+c.substring(0,1).toUpperCase()+c.substring(1)),a.style[c]=b[f]);"none"==b.userSelect&&(a.onselectstart=function(){return!1},a.ondragstart=function(){return!1})}}}}]).provider("$mobile",function(){this.defaults={set_browser_behaviors:!0},this.default_browser_behavior={userSelect:"none",touchAction:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"},this.$get=["$window","$document","$mobileUtils",function(a,b,c){var d=this,e={},f=0,g={},h={},i=function(b,c){a.setTimeout(function(){b.releasePointerCapture(c)},0)},j=function(b,d){b.bind(c.EVENT_TYPES[d],function(e){if(e=e.originalEvent||e,!(e.type.match(/mouse/i)&&1!=(e.which||e.button)||e.type.match(/pointerdown/i)&&0!=e.button)){var f,j,l,m=e.changedTouches&&e.changedTouches.length?e.changedTouches:e.touches&&e.touches.length?e.touches:[e],n={};for(f=0;f<m.length;++f){if(j=m[f],j.identifier="undefined"!=typeof j.identifier?j.identifier:"undefined"!=typeof j.pointerId?j.pointerId:1,d===c.EVENT_START){if(g[j.identifier]&&g[j.identifier].stopDetect(),l=b.data("__$mobile.config__"),!(l&&l.enabled&&l.pointers_count<l.pointers_max))continue;l.options.touch_active_class&&b.addClass(l.options.touch_active_class),g[j.identifier]=l,0==l.pointers_count&&(h[l]={}),h[l][j.identifier]=j,l.pointers_count=l.pointers_count+1,c.HAS_POINTEREVENTS&&(b[0].setPointerCapture||(b[0].setPointerCapture=b[0].msSetPointerCapture,b[0].releasePointerCapture=b[0].msReleasePointerCapture),b[0].setPointerCapture(j.identifier)),n[l]||(n[l]=[l])}else{if(!g[j.identifier])continue;l=g[j.identifier],h[l][j.identifier]=j,n[l]||(n[l]=[l]),d===c.EVENT_END&&(n[l].push(j.identifier),c.HAS_POINTEREVENTS&&i(b[0],j.identifier))}a.document.addEventListener||(j.pageX=j.clientX+a.document.body.scrollLeft,j.pageY=j.clientY+a.document.body.scrollTop)}for(l in n)n.hasOwnProperty(l)&&k(e,d,n[l].shift(),n[l])}})},k=function(a,b,d,e){if(d.enabled){var f=[];angular.forEach(h[d],function(a){this.push(a)},f),b===c.EVENT_END&&e.length-d.pointers_count>0&&(b=c.EVENT_MOVE),d.detect({center:c.getCenter(f),timeStamp:Date.now(),target:a.target,touches:f,eventType:b,srcEvent:a,preventDefault:function(){this.srcEvent.preventManipulation&&this.srcEvent.preventManipulation(),this.srcEvent.preventDefault?this.srcEvent.preventDefault():this.srcEvent.returnValue=!1},stopPropagation:function(){this.srcEvent.stopPropagation?this.srcEvent.stopPropagation():this.srcEvent.cancelBubble=!0},stopDetect:function(){return d.stopDetect()}})}if(b===c.EVENT_END)d.stopDetect();else for(var i=0;i<e.length;++i)delete g[e[i]],delete h[d][e[i]],d.pointers_count=d.pointers_count-1};return c.HAS_POINTEREVENTS?(c.EVENT_TYPES[c.EVENT_START]="pointerdown MSPointerDown",c.EVENT_TYPES[c.EVENT_MOVE]="pointermove MSPointerMove",c.EVENT_TYPES[c.EVENT_END]="pointerup pointercancel lostpointercapture MSPointerUp MSPointerCancel MSLostPointerCapture"):(c.EVENT_TYPES[c.EVENT_START]="touchstart mousedown",c.EVENT_TYPES[c.EVENT_MOVE]="touchmove mousemove",c.EVENT_TYPES[c.EVENT_END]="touchend touchcancel mouseup",j(b,c.EVENT_MOVE),j(b,c.EVENT_END),Date.now||(Date.now=function(){return(new Date).valueOf()})),{utils:c,register:function(a){d.defaults=angular.extend(a.defaults||{},d.defaults||{}),delete a.defaults,e[a.name]=a},gestureOn:function(a,b,i){var k,l,m=a.data("__$mobile.config__")||{id:void 0,handlers:{},registered:{},gestures:[],bind:function(a,b){return m.handlers[a]=m.handlers[a]||[],m.handlers[a].push(b),m},unbind:function(a,b){return void 0===b?delete m.handlers[a]:angular.arrayRemove(m.handlers[a],b),m},toString:function(){return m.id},extendEventData:function(a){var b,d,e=m.current.startEvent,f=a.timeStamp-e.timeStamp,g=a.center.pageX-e.center.pageX,h=a.center.pageY-e.center.pageY,i=c.getVelocity(f,g,h);if(e&&a.touches.length!=e.touches.length)for(e.touches=[],b=0,d=a.touches.length;d>b;b++)e.touches.push(a.touches[b]);return angular.extend(a,{deltaTime:f,deltaX:g,deltaY:h,velocityX:i.x,velocityY:i.y,distance:c.getDistance(e.center,a.center),angle:c.getAngle(e.center,a.center),direction:c.getDirection(e.center,a.center),scale:c.getScale(e.touches,a.touches),rotation:c.getRotation(e.touches,a.touches),startEvent:e}),a},detect:function(a){if(m.current){if(m.stopped)return}else m.stopped=!1,m.current={inst:m,startEvent:angular.extend({},a),lastEvent:!1,name:""};a=m.extendEventData(a);var b,c,d=0;for(b=m.gestures.length;b>d;d++)if(c=m.gestures[d],!m.stopped&&c.handler.call(m.registered[c.name],a,m)===!1){tracker.stopDetect();break}return m.current&&(m.current.lastEvent=a),a},stopDetect:function(){var b=h[m];m.options.touch_active_class&&a.removeClass(m.options.touch_active_class),b&&(delete h[m],angular.forEach(b,function(a,b){delete g[b]}),m.stopped=!0,m.pointers_count=0,m.current&&(m.previous=angular.extend({},m.current),m.current=null))},trigger:function(b,c){if(m.handlers[b])for(var d,e=m.handlers[b],d=0;d<e.length;++d)e[d].call(a,c);return m},enabled:!0,previous:void 0,current:void 0,pointers_count:0,pointers_max:1,options:void 0};if(m.id?i&&angular.extend(m.options,i):(i=angular.extend(angular.copy(d.defaults),i||{}),f+=1,m.id=f.toString(),m.options=i,a.data("__$mobile.config__",m),i.set_browser_behaviors&&c.stopDefaultBrowserBehavior(a[0],d.default_browser_behavior),a.scope().$on("$destroy",function(){m.stopDetect(),m.enabled=!1}),c.HAS_POINTEREVENTS?(j(a,c.EVENT_START),j(a,c.EVENT_MOVE),j(a,c.EVENT_END)):j(a,c.EVENT_START)),b)for(b=b.split(" "),k=0;k<b.length;k+=1)l=e[b[k]],m.registered[l.name]||(m.registered[l.name]={name:l.name},l.index=l.index||1e3,m.gestures.push(l),m.gestures.sort(function(a,b){return a.index<b.index?-1:a.index>b.index?1:0})),l.setup&&l.setup.call(m.registered[l.name],a,m),(m.options[l.name+"_max_pointers"]||1)>m.pointers_max&&(m.pointers_max=m.options[l.name+"_max_pointers"]||1);return m}}}]});